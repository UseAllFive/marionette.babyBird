!function(a){"function"==typeof define&&define.amd?define(["backbone","marionette","underscore","underscore.string"],a):a(Backbone,Marionette,_,_s)}(function(a,b,c,d){function e(a){function b(a,b){return j+b}return c.each(a,function(g,j){var k,l;if("object"==typeof g)a[j]=e(g);else if("string"==typeof g){if(k=f(g),g=k.string,g.split(/ /).length>i){for(l=0;h-1>l;l+=1)g=g.replace(/ ([^ ]+)$/,b);a[j]=g}c.each(k.positions,function(b){a[j]=d.splice(a[j],b.index,b.string.length,b.string)})}}),a}function f(a){var b,c,e,f,g;if(g={string:a,positions:[]},-1===a.indexOf("<a"))return g;for(c=a.match(/(<a.*?<\/a>)/g);c.length>0;)b=c.shift(),e=a.indexOf(b),f=d.repeat("_",b.length),a=d.splice(a,e,b.length,f),g.positions.push({index:e,string:b});return g.string=a,g}function g(b){var d;return b instanceof a.Collection?(c.each(b.models,function(a,c){b.models[c]=g(a)}),b=b.models):b instanceof a.Model?(d=b.id,c.each(b.attributes,function(a,c){b.attributes[c]=g(a)}),b=b.attributes,b.id=d):b=c.clone(b),c.each(b,function(a,c){"object"==typeof a&&(b[c]=g(a))}),b}var h=2,i=10,j=String.fromCharCode(160),k=b.Renderer.render;return b.Renderer.render=function(a,b){try{var c;if(!a)return;return c=g(b),c=e(c),k.call(this,a,c)}catch(d){return console.error(d),k.apply(this,arguments)}},b});